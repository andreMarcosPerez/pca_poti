# ------------------------------------------------------------------------------
# -- @head: MECAI | MAI5002 | Logistic Regression ------------------------------
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# -- Clean ---------------------------------------------------------------------
# ------------------------------------------------------------------------------

#rm(list=ls())
cat("\014")

# ------------------------------------------------------------------------------
# -- Variable ------------------------------------------------------------------
# ------------------------------------------------------------------------------

DATA.REL.PATH <- "../data/input/"
DATA.REL.PATH <- "../data/output/"
DATA.FILE     <- "facebook.csv"
DATA.FILE     <- "pca.csv"

# ------------------------------------------------------------------------------
# -- Library -------------------------------------------------------------------
# ------------------------------------------------------------------------------

if (!require("caret")) {
  
  install.packages("caret");
  library("caret");
}

# ------------------------------------------------------------------------------
# -- Main ----------------------------------------------------------------------
# ------------------------------------------------------------------------------

# ----------------------------------------
# -- Read data ---------------------------
# ----------------------------------------

data <- read.csv(file.path(DATA.REL.PATH,DATA.FILE));

# ----------------------------------------
# -- Regression --------------------------
# ----------------------------------------

set.seed(123)

  # ----------------------------------------
  # -- Train | 10-Fold Cross Validation ----
  # ----------------------------------------

  model <- caret::train(
    target ~ .,
    data = data,
    method = "lm", 
    trControl = trainControl(
      method = "cv", 
      number = 10,
      repeats = 10,
      verboseIter = TRUE
    )
  )

  # ----------------------------------------
  # -- Performance -------------------------
  # ----------------------------------------

  cat("\014")

  print("# ----------------------------------------")
  print("# -- Dataset | facebook.csv --------------")
  print("# ----------------------------------------")
  print(paste0("# -- RMSE............", round(mean(model$results$RMSE), digits = 4)))
  print("# ----------------------------------------")
  