# ------------------------------------------------------------------------------
# -- @head: MECAI | MAI5002 | PCA ----------------------------------------------
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# -- Clean ---------------------------------------------------------------------
# ------------------------------------------------------------------------------

rm(list=ls())
cat("\014")

# ------------------------------------------------------------------------------
# -- Variable ------------------------------------------------------------------
# ------------------------------------------------------------------------------

DATA.REL.PATH <- "../data/"
DATA.FILE     <- "facebook.csv"

# ------------------------------------------------------------------------------
# -- Library -------------------------------------------------------------------
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# -- Main ----------------------------------------------------------------------
# ------------------------------------------------------------------------------

# ----------------------------------------
# -- Data --------------------------------
# ----------------------------------------

# -- Read

X <- read.csv(file.path(DATA.REL.PATH,DATA.FILE));
X <- t(X);

# -- Center

for (i in 1:nrow(X)) {
  
  rowMean <- 0;
  
  for (j in 1:ncol(X)) {
    
    rowMean <- rowMean + X[i,j];
  }
  
  rowMean  <- (rowMean / ncol(X));
  X[i,] <- (X[i,] - rowMean);
 
}

# ----------------------------------------
# -- Covariance | Definition -------------
# ----------------------------------------

W <- (X %*% t(X)) / (ncol(X) - 1)

# ----------------------------------------
# -- Covariance | Function ---------------
# ----------------------------------------

Y <- cov(t(X))

# ----------------------------------------
# -- Covariance | Diff (ideally = 0) -----
# ----------------------------------------

Z <- W - Y
